

@model Models.Admission.AdmissionNotification
@{
    Layout = null;

    int slno = 1;
}

<div>
    <div class="content">
        <input type="hidden" value="@Model.Admsn_tentative_calndr_transId" name="Admsn_tentative_calndr_transId" />
        <input type="hidden" value="@Model.Exam_Notif_Number" name="Exam_Notif_Number" />
        <div class="container" style="background-color:white;box-shadow: 0 2px 4px rgba(0,0,0,0.6);margin-top:20px; padding:20px;">
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="headetitle">Upload Admission Calendar Details</h3>
                    <br />
                    <br />
                    <div class="row" id="tableGrid">
                        <table class="table table-bordered table-hover text-center " style="color:white; background-color:aliceblue" id="tblGrid">
                            <thead>
                                <tr class="text-center" style="color:black">
                                    <th>SlNo.</th>
                                    <th>Course Type</th>
                                    <th style="width:-550px;">Name of the Department</th>
                                    <th>Notification Number</th>
                                    <th>Notification Description</th>
                                    <th>Date and Time</th>
                                    <th style="text-align:center">Status</th>
                                    @*<th>Remarks</th>
                                        <th>ViewFile</th>*@

                                    <th style="width:250px;text-align:center">Action</th>

                                </tr>
                            </thead>
                            <tbody style="color:Black;">
                                <input type="hidden" value="@(Model.slno=1)" />
                                @foreach (var item in Model.GetUpdateNotifDet)
                                {
                                    <tr>
                                        <td>@(Model.slno++)</td>
                                        @*<td align="center" class="noExport">@item.Admission_Notif_Id</td>*@
                                        <td>@item.CourseTypeName</td>
                                        <td>@item.DeptName</td>
                                        <td>@item.Exam_Notif_Number</td>
                                        <td>@item.Exam_Notif_Desc</td>
                                        <td>@item.Exam_notif_date.ToString("dd/MM/yyyy")</td>
                                        <td>@item.exam_notif_status_desc</td>

                                        <td>
                                            @*@if (item.exam_notif_status_desc == "Changes/Modifications" || item.exam_notif_status_desc == "Modification To Published Notic" || item.exam_notif_status_desc == "Ready to Send for Approval")
                                                {
                                                    <a class=" btn btn-primary btn-xs" href='@Url.Action("AdmissionCalendar", "Admission", new { calendarId = item.Tentative_admsn_evnt_clndrId})'>Edit</a>
                                                }

                                                @if (item.exam_notif_status_desc == "Approved")
                                                {
                                                    <a class="btn btn-primary btn-xs" id="sendBtn" onclick="PublishDetails(@item.Admsn_tentative_calndr_transId,@item.exam_notif_status_id +2)">Publish</a>
                                                }

                                                <a class="btn btn-primary btn-xs" id="sendBtn" onclick="viewAdmissionCalendarDetails(@item.Tentative_admsn_evnt_clndrId)">View</a>*@

                                            @if (item.exam_notif_status_id == 110)
                                            {
                                                if (item.login_id == 1)
                                                {
                                                    <a class="btn btn-primary btn-xs" id="sendBtn" onclick="viewAdmissionCalendarDetails(@item.Tentative_admsn_evnt_clndrId)">View</a>
                                                    <a class="btn btn-primary btn-xs" id="sendBtn" onclick="PublishAdmissionCalNotification(@item.Tentative_admsn_evnt_clndrId)">Publish</a>
                                                }
                                                else
                                                {
                                                    <a class="btn btn-primary btn-xs" id="sendBtn" onclick="viewAdmissionCalendarDetails(@item.Tentative_admsn_evnt_clndrId)">View</a>
                                                }
                                            }
                                            else if (item.exam_notif_status_id == 100 || item.exam_notif_status_id == 102 || item.exam_notif_status_id == 108)
                                            {

                                                <a class="btn btn-primary btn-xs" id="sendBtn" onclick="viewAdmissionCalendarDetails(@item.Tentative_admsn_evnt_clndrId)">View</a>
                                                <a class=" btn btn-primary btn-xs" href='@Url.Action("CreateAdmissionNotification", "AdmissionNotification", new { NotificationId = item.Admission_Notif_Id})'>Edit</a>
                                            }
                                            else
                                            {
                                                <a class="btn btn-primary btn-xs" id="sendBtn" onclick="viewAdmissionCalendarDetails(@item.Tentative_admsn_evnt_clndrId)">View</a>
                                            }
                                        </td>

                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                    <div class="row" style="margin-left:10px;" id="ViewDetailsDiv">
                        <div class="row">
                            <span style="display:none" id="id"></span>

                            <div class="col-lg-2"><label>Course Type:</label></div>
                            <div class="col-lg-2">
                                <span id="course"></span>
                            </div>
                            <div class="col-lg-2"><label>Name of the Department:</label></div>
                            <div class="col-lg-2">
                                <span id="dept"></span>
                            </div>
                            <div class="col-lg-2"><label>Notification Number:</label></div>
                            <div class="col-lg-2">
                                <span id="notifynum"></span>
                            </div>
                        </div>

                        <br /><br />
                        <div class="row">

                            <div class="col-lg-2"><label>Notification Type:</label></div>
                            <div class="col-lg-2">
                                <span id="desc1"></span>
                            </div>
                            <div class="col-lg-2"><label>Date and Time:</label></div>
                            <div class="col-lg-2">
                                <span id="datenotify"></span>
                            </div>
                            <div class="col-lg-2"><label>Status</label></div>
                            <div class="col-lg-2">
                                <span id="statusdesc"></span>
                            </div>
                        </div>
                        <br /><br />
                        <div class="row">

                            <div class="col-lg-2"><label>Notification pending with:</label></div>
                            <div class="col-lg-2">
                                <span id="RecordLevel"></span>
                            </div>
                        </div>
                        <br /><br />
                        <div class="row">

                        </div>

                        <br /><br />
                        <div class="row">
                            <div class=" col-lg-offset-4 col-lg-2">
                                <a style="text-align:center; float:initial" class="btn btn-primary" onclick="GetClientReport()">View Notification Pdf</a>
                            </div>
                            <div class="col-lg-4">
                                <a style="text-align:center; float:initial" class="btn btn-primary" onclick="GetCommentTable1()">View Comments</a>
                            </div>
                        </div>
                        <br /><br />
                        <div class="row">
                            <div class="col-lg-offset-1 col-lg-2">
                                Remarks
                            </div>

                            <div class="col-lg-6">
                                <input type="text" multiple style="height:auto;" id="remarks" class="form-control" />
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-lg-offset-1 col-lg-2">
                                Forward To
                            </div>
                            <div class="col-lg-2">
                                <select class="form-control" id="users"></select>
                                <span id="spnselectdropdown" class="text-danger" style="display:none;">Please  Select Hierarcy level</span>
                            </div>
                            <div class="col-lg-7">
                                <a class=" btn btn-primary" id="sendBtn1" onclick="ForwardAdmissionCalendarNotification()">Forward</a>
                                <a class=" btn btn-primary" id="sendBtn3" onclick="ApproveAdmissionCalendarNotification()">Approve</a>
                                <a class=" btn btn-primary" id="sendBtnchanges" onclick="ChangesCalendarAdmissionNotification()">Changes/Modification</a>
                                <a class=" btn btn-primary" id="CancelBtn">Cancel</a>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="RemarksCommentsModal" role="dialog">
                        <div class="modal-dialog modal-xl" style="width: 60%; margin: 30px auto; padding: 2px;">
                            <div class="modal-content" style="padding:15px;">
                                <div class="modal-header">
                                    <h4 class="modal-title">Remark Details</h4>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <table class="table table-striped table-hover text-center shadow clswidth" id="CommentsTable11" style="width:100% !important" border="1" align="center"></table>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal" style="width: 20%;">OK</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $("#tblGrid").DataTable();
    function GetCommentTable1() {
        $('#RemarksCommentsModal').modal('show');
        var id = $('#id').html();
        $.ajax({
            type: "Get",
            url: "/Admission/GetCommentsCalendarFile",
            data: { id: id },
            success: function (data) {
                var t = $('#CommentsTable11').DataTable({
                    data: data,
                    destroy: true,
                    columns: [
                        { 'data': 'slno', 'title': 'Sl No', 'className': 'text-center' },
                        { 'data': 'createdatetime', 'title': 'Date', 'className': 'text-left' },
                        { 'data': 'Exam_Notif_Number', 'title': 'Notification Number', 'className': 'text-left' },
                        { 'data': 'comments', 'title': 'Descriptioon', 'className': 'text-left' },
                        { 'data': 'user_name', 'title': 'Designation', 'className': 'text-left' },

                    ]
                });
                t.on('order.dt search.dt', function () {
                    t.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                        cell.innerHTML = i + 1;
                    });
                }).draw();
                //NotifId = data[0].Exam_Notif_Number;
            }
        });
    }

    function GetClientReport() {
        var NotifId = $('#notifynum').html();
        var urlPath = "../../Content/Template/Notification_" + NotifId + ".pdf";
        window.open(urlPath, '_blank');
    }


</script>

